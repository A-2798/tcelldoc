<view class="data-v-6837bb2e"><canvas style="display:none;" canvas-id="mycanvas" disable-scroll="true" class="data-v-6837bb2e"></canvas><view data-event-opts="{{[['touchstart',[['hideDrawer',['$event']]]]]}}" class="content data-v-6837bb2e" bindtouchstart="__e"><scroll-view class="msg-list data-v-6837bb2e" scroll-y="true" scroll-with-animation="{{scrollAnimation}}" scroll-top="{{scrollTop}}" scroll-into-view="{{scrollToView}}" upper-threshold="50" data-event-opts="{{[['scrolltoupper',[['loadHistory',['$event']]]]]}}" bindscrolltoupper="__e"><block wx:if="{{isHistoryLoading}}"><view class="loading data-v-6837bb2e"><view class="spinner data-v-6837bb2e"><view class="rect1 data-v-6837bb2e"></view><view class="rect2 data-v-6837bb2e"></view><view class="rect3 data-v-6837bb2e"></view><view class="rect4 data-v-6837bb2e"></view><view class="rect5 data-v-6837bb2e"></view></view></view></block><block wx:for="{{msgList}}" wx:for-item="row" wx:for-index="index" wx:key="index"><view class="row data-v-6837bb2e" id="{{'msg'+row.msg.id}}"><block wx:if="{{row.type=='system'}}"><block class="data-v-6837bb2e"><view class="system data-v-6837bb2e"><block wx:if="{{row.msg.type=='text'}}"><view class="text data-v-6837bb2e">{{''+row.msg.content.text+''}}</view></block></view></block></block><block wx:if="{{row.type=='user'}}"><block class="data-v-6837bb2e"><block wx:if="{{row.msg.userinfo.uid==myuid}}"><view class="my data-v-6837bb2e"><view class="left data-v-6837bb2e"><block wx:if="{{row.msg.type=='text'}}"><view class="bubble data-v-6837bb2e"><rich-text nodes="{{row.msg.content.text}}" class="data-v-6837bb2e"></rich-text></view></block><block wx:if="{{row.msg.type=='voice'}}"><view data-event-opts="{{[['tap',[['playVoice',['$0'],[[['msgList','',index,'msg']]]]]]]}}" class="{{['bubble voice data-v-6837bb2e',playMsgid==row.msg.id?'play':'']}}" bindtap="__e"><view class="length data-v-6837bb2e">{{row.msg.content.msg.length}}</view><view class="icon my-voice data-v-6837bb2e"></view></view></block><block wx:if="{{row.msg.type=='img'}}"><view data-event-opts="{{[['tap',[['showPic',['$0'],[[['msgList','',index,'msg']]]]]]]}}" class="bubble img data-v-6837bb2e" bindtap="__e"><image style="{{'width:'+(row.msg.content.w+'px')+';'+('height:'+(row.msg.content.h+'px')+';')}}" src="{{row.msg.content.url}}" class="data-v-6837bb2e"></image></view></block></view><view class="right data-v-6837bb2e"><image src="{{row.msg.userinfo.face}}" class="data-v-6837bb2e"></image></view></view></block><block wx:if="{{row.msg.userinfo.uid!=myuid}}"><view class="other data-v-6837bb2e"><view class="left data-v-6837bb2e"><image src="{{row.msg.userinfo.face}}" class="data-v-6837bb2e"></image></view><view class="right data-v-6837bb2e"><view class="username data-v-6837bb2e"><view class="name data-v-6837bb2e">{{row.msg.userinfo.username}}</view><view class="time data-v-6837bb2e">{{row.msg.time}}</view></view><block wx:if="{{row.msg.type=='text'}}"><view class="bubble data-v-6837bb2e"><rich-text nodes="{{row.msg.content}}" class="data-v-6837bb2e"></rich-text></view></block><block wx:if="{{row.msg.type=='voice'}}"><view data-event-opts="{{[['tap',[['playVoice',['$0'],[[['msgList','',index,'msg']]]]]]]}}" class="{{['bubble voice data-v-6837bb2e',playMsgid==row.msg.id?'play':'']}}" bindtap="__e"><view class="icon other-voice data-v-6837bb2e"></view><view class="length data-v-6837bb2e">{{row.msg.content.msg.length}}</view></view></block><block wx:if="{{row.msg.type=='img'}}"><view data-event-opts="{{[['tap',[['showPic',['$0'],[[['msgList','',index,'msg']]]]]]]}}" class="bubble img data-v-6837bb2e" bindtap="__e"><image style="{{'width:'+(row.msg.content.w+'px')+';'+('height:'+(row.msg.content.h+'px')+';')}}" src="{{row.msg.content.url}}" class="data-v-6837bb2e"></image></view></block></view></view></block></block></block></view></block></scroll-view></view><view data-event-opts="{{[['touchmove',[['discard',['$event']]]]]}}" class="{{['popup-layer data-v-6837bb2e',popupLayerClass]}}" catchtouchmove="__e"><swiper class="{{['emoji-swiper data-v-6837bb2e',(hideEmoji)?'hidden':'']}}" indicator-dots="true" duration="150"><block wx:for="{{emojiList}}" wx:for-item="page" wx:for-index="pid" wx:key="pid"><swiper-item class="data-v-6837bb2e"><block wx:for="{{page}}" wx:for-item="em" wx:for-index="eid" wx:key="eid"><view data-event-opts="{{[['tap',[['addEmoji',['$0'],[[['emojiList','',pid],['','',eid]]]]]]]}}" bindtap="__e" class="data-v-6837bb2e"><image mode="widthFix" src="{{'./pagesB/emoji/'+em.url}}" class="data-v-6837bb2e"></image></view></block></swiper-item></block></swiper><view class="{{['more-layer data-v-6837bb2e',(hideMore)?'hidden':'']}}"><view class="list data-v-6837bb2e"><view data-event-opts="{{[['tap',[['chooseImage',['$event']]]]]}}" class="box data-v-6837bb2e" bindtap="__e"><view class="icon tupian2 data-v-6837bb2e"></view></view><view data-event-opts="{{[['tap',[['camera',['$event']]]]]}}" class="box data-v-6837bb2e" bindtap="__e"><view class="icon paizhao data-v-6837bb2e"></view></view></view></view></view><view data-event-opts="{{[['touchmove',[['discard',['$event']]]]]}}" class="{{['input-box data-v-6837bb2e',popupLayerClass]}}" catchtouchmove="__e"><view class="voice data-v-6837bb2e"><view data-event-opts="{{[['tap',[['switchVoice',['$event']]]]]}}" class="{{['icon data-v-6837bb2e',isVoice?'jianpan':'yuyin']}}" bindtap="__e"></view></view><view class="textbox data-v-6837bb2e"><view data-event-opts="{{[['touchstart',[['voiceBegin',['$event']]]],['touchmove',[['voiceIng',['$event']]]],['touchend',[['voiceEnd',['$event']]]],['touchcancel',[['voiceCancel',['$event']]]]]}}" class="{{['voice-mode data-v-6837bb2e',isVoice?'':'hidden',recording?'recording':'']}}" bindtouchstart="__e" catchtouchmove="__e" bindtouchend="__e" bindtouchcancel="__e">{{voiceTis}}</view><view class="{{['text-mode data-v-6837bb2e',isVoice?'hidden':'']}}"><view class="box data-v-6837bb2e"><textarea auto-height="true" show-confirm-bar="{{false}}" adjust-position="{{true}}" data-event-opts="{{[['focus',[['textareaFocus',['$event']]]],['input',[['__set_model',['','textMsg','$event',[]]]]]]}}" value="{{textMsg}}" bindfocus="__e" bindinput="__e" class="data-v-6837bb2e"></textarea></view><view data-event-opts="{{[['tap',[['chooseEmoji',['$event']]]]]}}" class="em data-v-6837bb2e" bindtap="__e"><view class="icon biaoqing data-v-6837bb2e"></view></view></view></view><view data-event-opts="{{[['tap',[['showMore',['$event']]]]]}}" class="more data-v-6837bb2e" bindtap="__e"><view class="icon add data-v-6837bb2e"></view></view><view data-event-opts="{{[['tap',[['sendText',['$event']]]]]}}" class="{{['send data-v-6837bb2e',isVoice?'hidden':'']}}" bindtap="__e"><view class="btn data-v-6837bb2e">发送</view></view></view><view class="{{['record data-v-6837bb2e',recording?'':'hidden']}}"><view class="{{['ing data-v-6837bb2e',willStop?'hidden':'']}}"><view class="icon luyin2 data-v-6837bb2e"></view></view><view class="{{['cancel data-v-6837bb2e',willStop?'':'hidden']}}"><view class="icon chehui data-v-6837bb2e"></view></view><view class="{{['tis data-v-6837bb2e',willStop?'change':'']}}">{{recordTis}}</view></view></view>