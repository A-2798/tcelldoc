(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesB/HM-chat/HM-chat"],{227:
/*!*******************************************************************************************************!*\
  !*** C:/Users/user/Documents/HBuilderProjects/tcelldoc/main.js?{"page":"pagesB%2FHM-chat%2FHM-chat"} ***!
  \*******************************************************************************************************/
/*! no static exports found */function(t,e,n){"use strict";(function(t){n(/*! uni-pages */4);i(n(/*! vue */2));var e=i(n(/*! ./pagesB/HM-chat/HM-chat.vue */228));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["createPage"])},228:
/*!************************************************************************************!*\
  !*** C:/Users/user/Documents/HBuilderProjects/tcelldoc/pagesB/HM-chat/HM-chat.vue ***!
  \************************************************************************************/
/*! no static exports found */function(t,e,n){"use strict";n.r(e);var i=n(/*! ./HM-chat.vue?vue&type=template&id=6837bb2e&scoped=true& */229),s=n(/*! ./HM-chat.vue?vue&type=script&lang=js& */231);for(var a in s)"default"!==a&&function(t){n.d(e,t,(function(){return s[t]}))}(a);n(/*! ./HM-chat.vue?vue&type=style&index=0&id=6837bb2e&lang=scss&scoped=true& */250);var r,o=n(/*! ../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */13),l=Object(o["default"])(s["default"],i["render"],i["staticRenderFns"],!1,null,"6837bb2e",null,!1,i["components"],r);l.options.__file="pagesB/HM-chat/HM-chat.vue",e["default"]=l.exports},229:
/*!*******************************************************************************************************************************!*\
  !*** C:/Users/user/Documents/HBuilderProjects/tcelldoc/pagesB/HM-chat/HM-chat.vue?vue&type=template&id=6837bb2e&scoped=true& ***!
  \*******************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(t,e,n){"use strict";n.r(e);var i=n(/*! -!../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./HM-chat.vue?vue&type=template&id=6837bb2e&scoped=true& */230);n.d(e,"render",(function(){return i["render"]})),n.d(e,"staticRenderFns",(function(){return i["staticRenderFns"]})),n.d(e,"recyclableRender",(function(){return i["recyclableRender"]})),n.d(e,"components",(function(){return i["components"]}))},230:
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/user/Documents/HBuilderProjects/tcelldoc/pagesB/HM-chat/HM-chat.vue?vue&type=template&id=6837bb2e&scoped=true& ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(t,e,n){"use strict";var i;n.r(e),n.d(e,"render",(function(){return s})),n.d(e,"staticRenderFns",(function(){return r})),n.d(e,"recyclableRender",(function(){return a})),n.d(e,"components",(function(){return i}));var s=function(){var t=this,e=t.$createElement;t._self._c},a=!1,r=[];s._withStripped=!0},231:
/*!*************************************************************************************************************!*\
  !*** C:/Users/user/Documents/HBuilderProjects/tcelldoc/pagesB/HM-chat/HM-chat.vue?vue&type=script&lang=js& ***!
  \*************************************************************************************************************/
/*! no static exports found */function(t,e,n){"use strict";n.r(e);var i=n(/*! -!../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib!../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./HM-chat.vue?vue&type=script&lang=js& */232),s=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e["default"]=s.a},232:
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/user/Documents/HBuilderProjects/tcelldoc/pagesB/HM-chat/HM-chat.vue?vue&type=script&lang=js& ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,s=n(/*! API/OSS.js */172),a=(n(/*! API/rongyun.js */9),n(/*! util/auth.js */8)),r=l(n(/*! util/UPNG.js */233)),o=n(/*! vuex */44);function l(t){return t&&t.__esModule?t:{default:t}}function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var h=(i={data:function(){return{textMsg:"",isHistoryLoading:!1,scrollAnimation:!1,scrollTop:0,scrollToView:"",msgList:[],msgImgList:[],myuid:0,RECORDER:t.getRecorderManager(),isVoice:!1,voiceTis:"按住 说话",recordTis:"手指上滑 取消发送",recording:!1,willStop:!1,initPoint:{identifier:0,Y:0},recordTimer:null,recordLength:0,AUDIO:t.createInnerAudioContext(),playMsgid:null,VoiceTimer:null,popupLayerClass:"",hideMore:!0,hideEmoji:!0,materialList:[],emojiList:[[{url:"d_aini.png",alt:"[爱你]"},{url:"d_aoteman.png",alt:"[奥特曼]"},{url:"d_baibai.png",alt:"[拜拜]"},{url:"d_beishang.png",alt:"[悲伤]"},{url:"d_bishi.png",alt:"[鄙视]"},{url:"d_bizui.png",alt:"[闭嘴]"},{url:"d_chanzui.png",alt:"[馋嘴]"},{url:"d_chijing.png",alt:"[吃惊]"},{url:"d_dahaqi.png",alt:"[哈欠]"},{url:"d_dalian.png",alt:"[打脸]"},{url:"d_ding.png",alt:"[顶]"},{url:"d_doge.png",alt:"[doge]"},{url:"d_feizao.png",alt:"[肥皂]"},{url:"d_ganmao.png",alt:"[感冒]"},{url:"d_guzhang.png",alt:"[鼓掌]"},{url:"d_haha.png",alt:"[哈哈]"},{url:"d_haixiu.png",alt:"[害羞]"},{url:"d_han.png",alt:"[汗]"},{url:"d_hehe.png",alt:"[微笑]"},{url:"d_heixian.png",alt:"[黑线]"},{url:"d_heng.png",alt:"[哼]"},{url:"d_huaxin.png",alt:"[色]"},{url:"d_jiyan.png",alt:"[挤眼]"},{url:"d_keai.png",alt:"[可爱]"}],[{url:"d_kelian.png",alt:"[可怜]"},{url:"d_ku.png",alt:"[酷]"},{url:"d_kun.png",alt:"[困]"},{url:"d_landelini.png",alt:"[白眼]"},{url:"d_lei.png",alt:"[泪]"},{url:"d_madaochenggong.png",alt:"[马到成功]"},{url:"d_miao.png",alt:"[喵喵]"},{url:"d_nanhaier.png",alt:"[男孩儿]"},{url:"d_nu.png",alt:"[怒]"},{url:"d_numa.png",alt:"[怒骂]"},{url:"d_nvhaier.png",alt:"[女孩儿]"},{url:"d_qian.png",alt:"[钱]"},{url:"d_qinqin.png",alt:"[亲亲]"},{url:"d_shayan.png",alt:"[傻眼]"},{url:"d_shengbing.png",alt:"[生病]"},{url:"d_shenshou.png",alt:"[草泥马]"},{url:"d_shiwang.png",alt:"[失望]"},{url:"d_shuai.png",alt:"[衰]"},{url:"d_shuijiao.png",alt:"[睡]"},{url:"d_sikao.png",alt:"[思考]"},{url:"d_taikaixin.png",alt:"[太开心]"},{url:"d_touxiao.png",alt:"[偷笑]"},{url:"d_tu.png",alt:"[吐]"},{url:"d_tuzi.png",alt:"[兔子]"}],[{url:"d_wabishi.png",alt:"[挖鼻]"},{url:"d_weiqu.png",alt:"[委屈]"},{url:"d_xiaoku.png",alt:"[笑cry]"},{url:"d_xiongmao.png",alt:"[熊猫]"},{url:"d_xixi.png",alt:"[嘻嘻]"},{url:"d_xu.png",alt:"[嘘]"},{url:"d_yinxian.png",alt:"[阴险]"},{url:"d_yiwen.png",alt:"[疑问]"},{url:"d_youhengheng.png",alt:"[右哼哼]"},{url:"d_yun.png",alt:"[晕]"},{url:"d_zhajipijiu.png",alt:"[炸鸡啤酒]"},{url:"d_zhuakuang.png",alt:"[抓狂]"},{url:"d_zhutou.png",alt:"[猪头]"},{url:"d_zuiyou.png",alt:"[最右]"},{url:"d_zuohengheng.png",alt:"[左哼哼]"},{url:"f_geili.png",alt:"[给力]"},{url:"f_hufen.png",alt:"[互粉]"},{url:"f_jiong.png",alt:"[囧]"},{url:"f_meng.png",alt:"[萌]"},{url:"f_shenma.png",alt:"[神马]"},{url:"f_v5.png",alt:"[威武]"},{url:"f_xi.png",alt:"[喜]"},{url:"f_zhi.png",alt:"[织]"},{url:"h_buyao.png",alt:"[NO]"}],[{url:"h_good.png",alt:"[good]"},{url:"h_haha.png",alt:"[haha]"},{url:"h_lai.png",alt:"[来]"},{url:"h_ok.png",alt:"[OK]"},{url:"h_quantou.png",alt:"[拳头]"},{url:"h_ruo.png",alt:"[弱]"},{url:"h_woshou.png",alt:"[握手]"},{url:"h_ye.png",alt:"[耶]"},{url:"h_zan.png",alt:"[赞]"},{url:"h_zuoyi.png",alt:"[作揖]"},{url:"l_shangxin.png",alt:"[伤心]"},{url:"l_xin.png",alt:"[心]"},{url:"o_dangao.png",alt:"[蛋糕]"},{url:"o_feiji.png",alt:"[飞机]"},{url:"o_ganbei.png",alt:"[干杯]"},{url:"o_huatong.png",alt:"[话筒]"},{url:"o_lazhu.png",alt:"[蜡烛]"},{url:"o_liwu.png",alt:"[礼物]"},{url:"o_lvsidai.png",alt:"[绿丝带]"},{url:"o_weibo.png",alt:"[围脖]"},{url:"o_weiguan.png",alt:"[围观]"},{url:"o_yinyue.png",alt:"[音乐]"},{url:"o_zhaoxiangji.png",alt:"[照相机]"},{url:"o_zhong.png",alt:"[钟]"}],[{url:"w_fuyun.png",alt:"[浮云]"},{url:"w_shachenbao.png",alt:"[沙尘暴]"},{url:"w_taiyang.png",alt:"[太阳]"},{url:"w_weifeng.png",alt:"[微风]"},{url:"w_xianhua.png",alt:"[鲜花]"},{url:"w_xiayu.png",alt:"[下雨]"},{url:"w_yueliang.png",alt:"[月亮]"}]],replacedStr:""}},onReady:function(){this.myuid=(0,a.getUid)()},onLoad:function(t){var e=this;this.getMsgList(),this.AUDIO.onEnded((function(t){e.playMsgid=null})),this.RECORDER.onStart((function(t){e.recordBegin(t)})),this.RECORDER.onStop((function(t){e.recordEnd(t)}))}},c(i,"onLoad",(function(){this.scrollTop=9999999})),c(i,"watch",{ryNewState:function(){null!=this.ryNewState&&this.messageType(this.ryNewState)}}),c(i,"computed",g({},(0,o.mapGetters)(["ryNewState"]))),c(i,"methods",{messageType:function(t){var e=this,n=new Date,i=t[0],s="",a={};if("RC:TxtMsg"==i.latestMessage.messageType){var r=e.replaceEmoji(i.latestMessage.content.content);console.log(r,"监听得到的经表情函数处理后的消息"),s="text",a={type:"user",msg:{id:i.unreadMessageCount,time:n.getHours()+":"+n.getMinutes(),type:s,userinfo:{uid:i.latestMessage.senderUserId,username:"医生019号",face:"https://dss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=3918800978,3848407993&fm=26&gp=0.jpg"},content:r}}}else if("RC:HQVCMsg"==i.latestMessage.messageType){s="voice";var o=parseInt(i.latestMessage.content.duration/60),l=i.latestMessage.content.duration%60;o=o<10?"0"+o:o,l=l<10?"0"+l:l;var u=o+":"+l;a={type:"user",msg:{id:i.unreadMessageCount,time:n.getHours()+":"+n.getMinutes(),type:s,userinfo:{uid:i.latestMessage.senderUserId,username:"医生019号",face:"https://dss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=3918800978,3848407993&fm=26&gp=0.jpg"},content:{url:i.latestMessage.content.remoteUrl,msg:{length:u}}}},console.log(a,"监听得到的语音")}else"RC:ImgMsg"==i.latestMessage.messageType&&(s="img",console.log(i.latestMessage,"监听得到的图片"));2==i.latestMessage.messageDirection&&e.screenMsg(a,!0)},sendmessageByRy:function(t,e){var n=this,i=this.$im.Conversation.get({targetId:"19",type:this.$ry.CONVERSATION_TYPE.PRIVATE});e==this.$ry.MESSAGE_TYPE.TEXT?i.send({messageType:e,content:{content:n.replacedStr}}).then((function(t){console.log("发送消息成功",t)})).catch((function(t){console.log("发送消息失败",t.code,t.msg)})):e==this.$ry.MESSAGE_TYPE.HQ_VOICE?(console.log(t,"viocery"),i.send({messageType:e,content:{remoteUrl:t.msg.content.url,duration:t.msg.content.msg.time,type:"aac"}}).then((function(t){console.log("发送语音消息成功",t)}))):e==this.$ry.MESSAGE_TYPE.IMAGE&&(console.log(t,"666666"),i.send({messageType:e,content:{content:t.base64_path,imageUri:t.url}}).then((function(t){console.log("发送图片消息成功",t)})))},screenMsg:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this;if("system"==e.type)switch(e.msg.type){case"text":this.addSystemTextMsg(e);break}else if("user"==e.type){switch(e.msg.type){case"text":n||this.sendmessageByRy(e.msg.content,i.$ry.MESSAGE_TYPE.TEXT),this.addTextMsg(e);break;case"voice":n||this.sendmessageByRy(e,i.$ry.MESSAGE_TYPE.HQ_VOICE),this.addVoiceMsg(e);break;case"img":n||this.sendmessageByRy(e.msg.content,i.$ry.MESSAGE_TYPE.IMAGE),this.addImgMsg(e);break}console.log("用户消息"),e.msg.userinfo.uid!=this.myuid&&(console.log("振动"),t.vibrateLong())}this.$nextTick((function(){this.scrollToView="msg"+e.msg.id}))},loadHistory:function(t){if(!this.isHistoryLoading){this.isHistoryLoading=!0,this.scrollAnimation=!1;this.msgList[0].msg.id}},getMsgList:function(){for(var t=[],e=0;e<t.length;e++)"user"==t[e].type&&"img"==t[e].msg.type&&(t[e].msg.content=this.setPicSize(t[e].msg.content),this.msgImgList.push(t[e].msg.content.url));this.msgList=t,this.$nextTick((function(){this.scrollTop=9999,this.$nextTick((function(){this.scrollAnimation=!0}))}))},setPicSize:function(e){var n=t.upx2px(350),i=t.upx2px(350);if(e.w>n||e.h>i){var s=e.w/e.h;e.w=s>1?n:i*s,e.h=s>1?n/s:i}return e},showMore:function(){this.isVoice=!1,this.hideEmoji=!0,this.hideMore?(this.hideMore=!1,this.openDrawer()):this.hideDrawer()},openDrawer:function(){this.popupLayerClass="showLayer"},hideDrawer:function(){var t=this;this.popupLayerClass="",setTimeout((function(){t.hideMore=!0,t.hideEmoji=!0}),150)},chooseImage:function(){this.getMedia("album")},camera:function(){this.getMedia("camera")},getMedia:function(e){var n=this,i=this;this.hideDrawer(),t.chooseMedia({mediaType:["image","video"],sourceType:[e],sizeType:["original","compressed"],success:function(e){i.weixin_img(0,e).then((function(){setTimeout((function(){for(var i=function(i){e.tempFiles[i]&&t.getImageInfo({src:e.tempFiles[i].tempFilePath,success:function(t){var s={url:e.tempFiles[i].tempFilePath,w:e.width,h:e.height,base64_path:e.tempFiles[i].Base64_Path};n.sendMsg(s,"img")}})},s=0;s<e.tempFiles.length;s++)i(s)}),100)}))}})},weixin_img:function(e,n){var i=this;return new Promise((function(s){var a=i;t.getImageInfo({src:n.tempFiles[e].tempFilePath,success:function(t){var i=wx.createCanvasContext("mycanvas",this),s=t.width,o=t.height,l=2;while(s>200||o>200)s=Math.trunc(t.width/l),o=Math.trunc(t.height/l),l++;i.drawImage(n.tempFiles[e].tempFilePath,0,0,s,o),i.draw(),wx.canvasGetImageData({canvasId:"mycanvas",x:0,y:0,width:s,height:o,success:function(t){var i=wx.getSystemInfoSync().platform;"ios"==i&&(t=a.reverseImgData(t));var l=r.default.encode([t.data.buffer],s,o),u=wx.arrayBufferToBase64(l);n.tempFiles[e].Base64_Path=u,a.materialList=a.materialList.concat(n.tempFiles[e]),console.log(n.tempFiles[e].Base64_Path,"wcl"),e!=n.tempFiles.length-1&&a.weixin_img(e+1,n)}},this)}}),s()}))},reverseImgData:function(t){for(var e=t.width,n=t.height,i=0,s=0;s<n/2;s++)for(var a=0;a<4*e;a++)i=t.data[s*e*4+a],t.data[s*e*4+a]=t.data[(n-s-1)*e*4+a],t.data[(n-s-1)*e*4+a]=i;return t},chooseEmoji:function(){this.hideMore=!0,this.hideEmoji?(this.hideEmoji=!1,this.openDrawer()):this.hideDrawer()},addEmoji:function(t){this.textMsg+=t.alt},textareaFocus:function(){"showLayer"==this.popupLayerClass&&0==this.hideMore&&this.hideDrawer()},sendText:function(){if(this.hideDrawer(),this.textMsg){var t=this.replaceEmoji(this.textMsg),e={text:t};console.log(this.textMsg,"5255"),this.replacedStr=this.textMsg,this.sendMsg(e,"text"),this.textMsg=""}},replaceEmoji:function(t){var e=this,n=t.replace(/\[([^(\]|\[)]*)\]/g,(function(t,n){for(var i=0;i<e.emojiList.length;i++)for(var s=e.emojiList[i],a=0;a<s.length;a++){var r=s[a];if(r.alt==t){var o='<img src="https://kz-open-resources.oss-cn-beijing.aliyuncs.com/tcell/images/InternetmemeImages/'+r.url+'" width="32px" height="32px"/>';return console.log("imgstr: "+o),o}}}));return'<div style="display: flex;align-items: center;word-wrap:break-word;">'+n+"</div>"},sendMsg:function(t,e){var n=this,i=new Date,s=0;s++;var a={type:"user",msg:{id:s,time:i.getHours()+":"+i.getMinutes(),type:e,userinfo:{uid:n.myuid,username:"大黑哥",face:"https://dss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=2146034403,1504718527&fm=26&gp=0.jpg"},content:t}};console.log(a),this.screenMsg(a)},addTextMsg:function(t){console.log(t,"新增加的消息"),this.msgList.push(t),console.log(this.msgList,"增加后的消息总表")},addVoiceMsg:function(t){console.log(t,"语音消息"),console.log(t.msg.content.url,"ssss"),this.msgList.push(t)},addImgMsg:function(t){t.msg.content=this.setPicSize(t.msg.content),this.msgImgList.push(t.msg.content.url),this.msgList.push(t)},addRedEnvelopeMsg:function(t){this.msgList.push(t)},addSystemTextMsg:function(t){this.msgList.push(t)},uploadOss:function(e){var n=this;console.log(e.url,"path");var i=RegExp(/mp3/),a=".jpg",r="image";i.test(e.url)&&(a=".mp3",r="audio");var o="chat/"+r+"/";(0,s.getPolicyPrivate)(o).then((function(i){var r=i[1].data.data,l=new Date,u=l.getFullYear()+"-"+(l.getMonth()+1>9?l.getMonth()+1:"0"+(l.getMonth()+1))+"/patientVioce--"+l.getDate()+"day"+l.getHours()+"hours"+l.getMinutes()+"minutes"+l.getSeconds()+"seconds";function g(t){for(var e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",n="",i=t;i>0;--i)n+=e[Math.floor(Math.random()*e.length)];return n+(new Date).valueOf()}var c=u+g(6);t.uploadFile({url:r.host,filePath:e.url,name:"file",formData:{key:o+c+a,policy:r.policy,OSSAccessKeyId:r.accessid,signature:r.signature},success:function(i){(0,s.signatureUrl)(r.host+"/"+o+c+a).then((function(i){201==i[1].data.code?n.sendMsg({url:i[1].data.data,msg:e},"voice"):t.showToast({title:i[1].data.data})})).catch((function(e){t.showToast({title:e})}))},fail:function(t){console.log(t)}})}))},showPic:function(e){t.previewImage({indicator:"none",current:e.content.url,urls:this.msgImgList})},playVoice:function(t){console.log(t),this.playMsgid=t.id,this.AUDIO.src=t.content.url,this.$nextTick((function(){this.AUDIO.play()}))},voiceBegin:function(t){t.touches.length>1||(this.initPoint.Y=t.touches[0].clientY,this.initPoint.identifier=t.touches[0].identifier,this.RECORDER.start({format:"mp3"}))},recordBegin:function(t){var e=this;this.recording=!0,this.voiceTis="松开 结束",this.recordLength=0,this.recordTimer=setInterval((function(){e.recordLength++}),1e3)},voiceCancel:function(){this.recording=!1,this.voiceTis="按住 说话",this.recordTis="手指上滑 取消发送",this.willStop=!0,this.RECORDER.stop()},voiceIng:function(e){if(this.recording){var n=e.touches[0];this.initPoint.Y-n.clientY>=t.upx2px(100)?(this.willStop=!0,this.recordTis="松开手指 取消发送"):(this.willStop=!1,this.recordTis="手指上滑 取消发送")}},voiceEnd:function(t){this.recording&&(this.recording=!1,this.voiceTis="按住 说话",this.recordTis="手指上滑 取消发送",this.RECORDER.stop())},recordEnd:function(t){if(clearInterval(this.recordTimer),this.willStop)console.log("取消发送录音");else{var e={length:0,url:t.tempFilePath,time:this.recordLength},n=parseInt(this.recordLength/60),i=this.recordLength%60;n=n<10?"0"+n:n,i=i<10?"0"+i:i,e.length=n+":"+i,console.log(e,"msg.url"),this.uploadOss(e)}this.willStop=!1},switchVoice:function(){this.hideDrawer(),this.isVoice=!this.isVoice},discard:function(){}}),i);e.default=h}).call(this,n(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["default"])},250:
/*!**********************************************************************************************************************************************!*\
  !*** C:/Users/user/Documents/HBuilderProjects/tcelldoc/pagesB/HM-chat/HM-chat.vue?vue&type=style&index=0&id=6837bb2e&lang=scss&scoped=true& ***!
  \**********************************************************************************************************************************************/
/*! no static exports found */function(t,e,n){"use strict";n.r(e);var i=n(/*! -!../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src??ref--8-oneOf-1-3!../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./HM-chat.vue?vue&type=style&index=0&id=6837bb2e&lang=scss&scoped=true& */251),s=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e["default"]=s.a},251:
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/user/Documents/HBuilderProjects/tcelldoc/pagesB/HM-chat/HM-chat.vue?vue&type=style&index=0&id=6837bb2e&lang=scss&scoped=true& ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(t,e,n){}},[[227,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pagesB/HM-chat/HM-chat.js.map